<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport"    content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="author"      content="">

<link href="atom.xml" type="application/atom+xml" rel="alternate" title="Atom feed for Blog: Model Train-related Notes" />

<meta property="og:url"         content="https://www.alfray.com/trains/blog/train/2024-10-14_conductor_2_freight_starts_w_ce787171.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Conductor 2: Freight starts when Passenger goes into Error" />

<meta property="og:description" content="In the old Conductor 1, anytime the train sequence did not work as expected, the engine simply stopped everything, and we had to manually replace the trains as expected and restart everything.Thus, when I redesigned the new Conductor 2, I added some “recovery” functionality -- the idea is that if the train sequence does not happen as expected, the automation engine should do something to try to recover the trains." />


<meta name="twitter:card"        content="summary" />
<!-- meta name="twitter:site"    content="@flickr" / -->
<meta name="twitter:title"       content="Conductor 2: Freight starts when Passenger goes into Error" />

<meta name="twitter:description" content="In the old Conductor 1, anytime the train sequence did not work as expected, the engine simply stopped everything, and we had to manually replace the trains as expected and restart everything.Thus, when I redesigned the new Conductor 2, I added some “recovery” functionality -- the idea is that if the train sequence does not happen as expected, the automation engine should do something to try to recover the trains." />


<title>Blog: Model Train-related Notes</title>

<script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5c66171070e9220011ed1c61&product=inline-share-buttons" async="async"></script>

<!-- Custom styles for this template -->
<style type="text/css">
body {
    font-family: sans-serif;
    margin: 0;
}

.main {
    margin: 8px;
}

p, span {
    line-height: 1.2;
    text-align: justify;
}

p.console {
    margin: 0;
    padding: 0;
}

.container {
    max-width: 95%;
}

@media screen and (min-width: 600px) {
    .container {
        max-width: 60rem;
    }
}

.center-horiz {
    margin: auto;
}

.no-margin-container {
}

/* Header + Title */
.blog-header {
  margin-bottom: 3rem;
  background-color: #428bca;
  box-shadow: inset 0 -.1rem .25rem rgba(0,0,0,.1);
}


.banner-bg-image {
    height: 50px;
    background-image: url("header.jpg");
    background-position: center;
    background-size: 100% auto;
}

@media screen and (min-width: 600px) {
    .banner-bg-image {
        height: 200px;
    }
}


.title-container {
    color: #fff;
    padding: 1rem;
    line-height: 1.5;
    font-weight: 500;
    font-size: 24px;
    font-family: sans-serif;
}

.title-container a {
    color: #fff;
    text-decoration: none;
}

.post-container {
}

.bottom-container {
    margin-top: 8px;
    color: #fff;
    background-color: #428bca;
    font-family: sans-serif;
    text-align: center;
    font-size: small;
    line-height: 1rem;
}

@media screen and (min-width: 600px) {
    .bottom-container {
        font-size: x-small;
    }
}

.post-title-container {
    position: relative;
    background-color: #428bca;
    padding: 0.5rem;
}

.post-title {
    display: inline;
    color: #fff;
    font-weight: 500;
    font-family: sans-serif;
    font-size: 1.5em;
}

a.post-title-link {
    color: #fff;
    text-decoration: none;
}

.post-cat {
    position: absolute;
    right: 0;
    top: 0;
    bottom: 0;
    padding: 0.25rem;
    background-color: #d0e0e3;
    color: #000;
    font-weight: 500;
    font-family: sans-serif;
    font-size: 1.5em;
}

a.post-cat-link {
    color: #000;
    text-decoration: none;
}

.post-cat-label {
    display: block;
    text-align: right;
    color: #000;
    font-size: 0.4em;
}

.prev-next-container {
    overflow: auto;
}

.prev-page {
    float: left;
    line-height: 2em;
}

.next-page {
    float: right;
    line-height: 2em;
}

h1, h2, h3, h4, h5, h6 {
    font-family: sans-serif;
    font-weight: bold;
}

.text-hide {
    font: 0/0 a;
    color: transparent;
    text-shadow: none;
    background-color: transparent;
    border: 0;
}

td p {
    margin: 0;
}


</style>
</head>

<body>

<header class="blog-header">

    <div class="no-margin-container banner-bg-image text-hide">
        Site Banner Image
    </div>

    <div class="title-container">
        <a href="https://www.alfray.com/trains/">Ralf's Train Pages</a>
        
        /
        <a href="0001.html">Blog: Model Train-related Notes</a>
        
    </div>
</header>

<main role="main">
<div class="main">
<div class="container center-horiz">

<p><span> </span></p>
<p><span></span></p>
<p><span> </span></p>
<table style="border-collapse:collapse;border-spacing:0;margin-left:auto;margin-right:auto">
 <tbody>
  <tr style="height:0pt">
   <td colspan="1" rowspan="1" style="background-color:rgb(103, 78, 167);border-bottom-color:rgb(255, 255, 255);border-bottom-style:solid;border-bottom-width:1pt;border-left-color:rgb(255, 255, 255);border-left-style:solid;border-left-width:1pt;border-right-color:rgb(255, 255, 255);border-right-style:solid;border-right-width:1pt;border-top-color:rgb(255, 255, 255);border-top-style:solid;border-top-width:1pt;padding:7.2pt 7.2pt 7.2pt 7.2pt;vertical-align:top;width:119.5pt"><p style="text-align:center"><span style="-webkit-text-decoration-skip:none;color:rgb(255, 217, 102);font-size:14pt;font-weight:700;text-decoration:underline;text-decoration-skip-ink:none"><a href="https://www.alfray.com/trains/randall/index.html" style="color:inherit;text-decoration:inherit">Introduction</a></span></p></td>
   <td colspan="1" rowspan="1" style="background-color:rgb(103, 78, 167);border-bottom-color:rgb(255, 255, 255);border-bottom-style:solid;border-bottom-width:1pt;border-left-color:rgb(255, 255, 255);border-left-style:solid;border-left-width:1pt;border-right-color:rgb(255, 255, 255);border-right-style:solid;border-right-width:1pt;border-top-color:rgb(255, 255, 255);border-top-style:solid;border-top-width:1pt;padding:7.2pt 7.2pt 7.2pt 7.2pt;vertical-align:top;width:119.5pt"><p style="text-align:center"><span style="-webkit-text-decoration-skip:none;color:rgb(255, 217, 102);font-size:14pt;font-weight:700;text-decoration:underline;text-decoration-skip-ink:none"><a href="https://www.alfray.com/trains/blog/randall/" style="color:inherit;text-decoration:inherit">Blog &amp; News</a></span></p></td>
   <td colspan="1" rowspan="1" style="background-color:rgb(103, 78, 167);border-bottom-color:rgb(255, 255, 255);border-bottom-style:solid;border-bottom-width:1pt;border-left-color:rgb(255, 255, 255);border-left-style:solid;border-left-width:1pt;border-right-color:rgb(255, 255, 255);border-right-style:solid;border-right-width:1pt;border-top-color:rgb(255, 255, 255);border-top-style:solid;border-top-width:1pt;padding:7.2pt 7.2pt 7.2pt 7.2pt;vertical-align:top;width:119.5pt"><p style="text-align:center"><span style="-webkit-text-decoration-skip:none;color:rgb(255, 217, 102);font-size:14pt;font-weight:700;text-decoration:underline;text-decoration-skip-ink:none"><a href="https://www.alfray.com/trains/randall/about.html" style="color:inherit;text-decoration:inherit">About the Model Railroad</a></span></p></td>
   <td colspan="1" rowspan="1" style="background-color:rgb(103, 78, 167);border-bottom-color:rgb(255, 255, 255);border-bottom-style:solid;border-bottom-width:1pt;border-left-color:rgb(255, 255, 255);border-left-style:solid;border-left-width:1pt;border-right-color:rgb(255, 255, 255);border-right-style:solid;border-right-width:1pt;border-top-color:rgb(255, 255, 255);border-top-style:solid;border-top-width:1pt;padding:7.2pt 7.2pt 7.2pt 7.2pt;vertical-align:top;width:119.5pt"><p style="text-align:center"><span style="-webkit-text-decoration-skip:none;color:rgb(255, 217, 102);font-size:14pt;font-weight:700;text-decoration:underline;text-decoration-skip-ink:none"><a href="https://www.alfray.com/trains/randall/rtac.html" style="color:inherit;text-decoration:inherit">RTAC Software</a></span></p></td>
   <td colspan="1" rowspan="1" style="background-color:rgb(103, 78, 167);border-bottom-color:rgb(255, 255, 255);border-bottom-style:solid;border-bottom-width:1pt;border-left-color:rgb(255, 255, 255);border-left-style:solid;border-left-width:1pt;border-right-color:rgb(255, 255, 255);border-right-style:solid;border-right-width:1pt;border-top-color:rgb(255, 255, 255);border-top-style:solid;border-top-width:1pt;padding:7.2pt 7.2pt 7.2pt 7.2pt;vertical-align:top;width:119.5pt"><p style="text-align:center"><span style="-webkit-text-decoration-skip:none;color:rgb(255, 217, 102);font-size:14pt;font-weight:700;text-decoration:underline;text-decoration-skip-ink:none"><a href="https://www.alfray.com/trains/randall/videos.html" style="color:inherit;text-decoration:inherit">Videos</a></span></p></td>
  </tr>
 </tbody>
</table>
<p></p>
<p><span style="font-style:italic">Model Train-related Notes Blog -- t</span><span style="font-style:italic">hese are personal notes and musings on the subject of model train control, automation, electronics, or whatever I find interesting. I also have more posts in a blog dedicated to the maintenance of the </span><span style="-webkit-text-decoration-skip:none;color:rgb(17, 85, 204);font-style:italic;text-decoration:underline;text-decoration-skip-ink:none"><a href="https://www.alfray.com/trains/blog/randall/" style="color:inherit;text-decoration:inherit">Randall Museum Model Railroad</a></span><span style="font-style:italic">.</span></p>
<p><span></span></p>

<div class="prev-next-container">


    <span class="prev-page"><a href="2024-11-21_dc-dc_boost_step-up_converter_xh-m411.html">⇐ Newer Post</a><br/></span>
    <span class="next-page"><a href="2024-10-12_conductor_2_sensor_issues_on_483b2f5d.html">Older Post ⇒</a><br/></span>

</div>


    <div class="post-container">
    <div class="post-title-container"><h2 class="post-title">2024-10-14 - Conductor 2: Freight starts when Passenger goes into Error</h2>
    <span class="post-cat" title="Category">
            <span class="post-cat-label">Category</span>
            <span class="post-cat-text">Rtac</span>
    </span>
    </div>


    <p><span></span></p>
<p></p>
<p><span>In the old Conductor 1, anytime the train sequence did not work as expected, the engine simply stopped everything, and we had to manually replace the trains as expected and restart everything.<br>Thus, when I redesigned the new </span><span style="-webkit-text-decoration-skip:none;color:rgb(17, 85, 204);text-decoration:underline;text-decoration-skip-ink:none"><a href="https://www.alfray.com/trains/randall/rtac" style="color:inherit;text-decoration:inherit">Conductor 2</a></span><span>, I added some “recovery” functionality -- the idea is that if the train sequence does not happen as expected, the automation engine should do something to try to recover the trains.</span></p>
<p></p>
<p><span>Unfortunately, the idea of “recovery” is basically to more or less predict the unpredictable and decide what the automation program should do in that case. Which means there are always cases that one never thought about because that “could never happen” and thus such cases are not handled. Today is one such case.</span></p>
<p></p>
<p><span>Orion and I have been slowly working on fixing the Branchline T324 turnout. That involves crawling through one of the mountain access holes, and then we need to reach the Branchline over the Mainline track. To make it more fun, that’s one of the tracks used by the Passenger train automation.</span></p>
<p></p>
<p><span>Twice I’ve seen the Passenger train go into error mode while we were trying to work on the Branchline T324 turnout. What was even more puzzling is that the Passenger was at Summit and then the Freight train just… started! Suddenly, on the </span><span style="font-style:italic">same track</span><span>, I had the Passenger train go into recovery and thus reversing towards the station whilst at the same time I had the Freight train leaving the station… Each going towards each other in the opposite direction. Not exactly a good scenario.</span></p>
<p></p>
<p><span>Hilarity ensues.</span></p>
<p></p>
<p><span>The first part of the puzzle was easy to find: when we crawl into the mountain access hole, we somehow activate the block B340. It’s not exactly clear </span><span style="font-style:italic">why</span><span>&nbsp;and </span><span style="font-style:italic">how</span><span>&nbsp;that happens, yet that sure is the result.</span></p>
<p></p>
<p><span>Here’s an excerpt from </span><span style="font-style:italic">conductor-log-2024-10-12-08-40-03.txt</span><span>:</span></p>
<p><span></span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:42:22.404 R Sequence Mainline #3 Passenger (8330) : ACTIVATED</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:42:22.404 B S/NS787 B503b : EMPTY after 374.60 seconds</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">…</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:26.205 B S/NS775 B360 : TRAILING after 24.67 seconds</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:26.205 B S/NS776 B370 : OCCUPIED after 714.77 seconds</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:26.236 T @timer@4 : start:4</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:29.142 S S/NS797 AIU-Motion : OFF</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:30.255 T @timer@4 : activated</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:30.256 T @timer@17 : start:17</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:30.256 D 8330 : 10</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:30.506 D 8330 : Bell ON</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:30.507 D 8330 : F1 ON</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:32.764 S S/NS797 AIU-Motion : ON</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:39.914 S S/NS774 B340 : ON</span><span style="font-size:9pt;font-weight:700"><br></span><span style="font-weight:700">⇒ Block B340 suddenly got activated when trying to work </span><span style="font-weight:700">on the Branchline. Train 8330 is on B370 (Summit).</span><span style="font-size:9pt;font-weight:700"><br></span><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:39.915 R Sequence Mainline #3 Passenger (8330) : ERROR Sequence Mainline #3 Passenger (8330) has unexpected occupied blocks out of &lt;B370&gt;: [&lt;B340 [NS774]&gt;]</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:39.916 R Sequence Mainline #3 Passenger (8330) : ERROR<br></span><span style="font-weight:700">⇒ Automation goes into error mode because an unexpected block suddenly gets occupied</span><span>.</span><span style="font-family:&quot;Consolas&quot;;font-size:9pt"><br></span><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:39.920 R Sequence Mainline #3 Passenger (8330) : {"name":"Passenger","th":"PA","act":2,"err":true,"nodes":[{"n":"B503b","ms":17873},{"n":"B503a","ms":10133},{"n":"B504","ms":19340},{"n":"B321","ms":55122},{"n":"B330","ms":22999},{"n":"B340","ms":33531},{"n":"B360","ms":24666},{"n":"B370","ms":13711}]}</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:39.923 D 8330 : 0</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:40.424 D 8330 : Sound OFF</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:40.424 D 8330 : F8 OFF</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">…</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:40.630 R Sequence Mainline #3 Passenger (8330) : IDLE</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:40.635 R Sequence Mainline #3 Passenger (8330) : {"name":"Passenger","th":"PA","act":2,"err":true,"nodes":[{"n":"B503b","ms":17873},{"n":"B503a","ms":10133},{"n":"B504","ms":19340},{"n":"B321","ms":55122},{"n":"B330","ms":22999},{"n":"B340","ms":33531},{"n":"B360","ms":24666},{"n":"B370.1","ms":13711},{"n":"B370.2","ms":14425}]}</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:40.637 B S/NS775 B360 : EMPTY after 14.43 seconds<br></span><span style="font-weight:700">⇒ There’s motion in the room and now the Freight train starts, since the Passenger one is no longer active</span><span>.</span><span style="font-family:&quot;Consolas&quot;;font-size:9pt"><br></span><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:40.638 R Sequence Mainline #4 Freight (1067) : ACTIVATED</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:40.638 B S/NS769 B311 : EMPTY after 311.24 seconds</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:41.140 D 8330 : F5 OFF</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:41.141 B S/NS769 B311 : OCCUPIED after 0.50 seconds</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:41.141 R Sequence Mainline #4 Freight (1067) : ACTIVE</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:41.175 D 1067 : Light ON</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:45:41.276 D 1067 : Sound ON</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">…<br></span><span style="font-weight:700">⇒ A second later, a delayed timer activates which returns the Passenger train towards the station</span><span>.</span><span style="font-family:&quot;Consolas&quot;;font-size:9pt"><br></span><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:46:17.295 T @timer@30 : activated</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:46:17.295 D 8330 : Bell OFF</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:46:17.295 D 8330 : F1 OFF</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:46:17.296 D 8330 : Horn</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">16:46:17.996 D 8330 : -10 &nbsp; </span><span style="font-size:9pt;font-weight:700">← This is the Passenger train</span></p>
<p></p>
<p><span>This “@timer@30” is internal name for “Delay_B370_Pause_Delay” -- the normal behavior at Summit is to pause then reverse after 30 seconds at speed 10:</span></p>
<p style="margin-left:36pt" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">onEnter {</span></p>
<p style="margin-left:36pt" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">&nbsp; &nbsp;after (AM_Data.Delay_B370_Entrance) then {</span></p>
<p style="margin-left:36pt" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">&nbsp; &nbsp; &nbsp; &nbsp;// Forward</span></p>
<p style="margin-left:36pt" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">&nbsp; &nbsp; &nbsp; &nbsp;PA.forward(AM_Data.Summit_Speed)</span></p>
<p style="margin-left:36pt" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">&nbsp; &nbsp; &nbsp; &nbsp;PA.bell(On)</span></p>
<p style="margin-left:36pt" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">&nbsp; &nbsp;} and_after (AM_Data.Delay_B370_Forward_Stop) then {</span></p>
<p style="margin-left:36pt" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">&nbsp; &nbsp; &nbsp; &nbsp;PA.stop()</span></p>
<p style="margin-left:36pt" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">&nbsp; &nbsp; &nbsp; &nbsp;PA.horn()</span></p>
<p style="margin-left:36pt" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">&nbsp; &nbsp;} and_after (AM_Data.Delay_B370_Pause_Delay) then {</span></p>
<p style="margin-left:36pt" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">&nbsp; &nbsp; &nbsp; &nbsp;// Stopped</span></p>
<p style="margin-left:36pt" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">&nbsp; &nbsp; &nbsp; &nbsp;PA.bell(Off)</span></p>
<p style="margin-left:36pt" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">&nbsp; &nbsp; &nbsp; &nbsp;PA.horn()</span></p>
<p style="margin-left:36pt" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">&nbsp; &nbsp; &nbsp; &nbsp;PA.reverse(AM_Data.Summit_Speed)</span></p>
<p style="margin-left:36pt" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">&nbsp; &nbsp;}</span></p>
<p style="margin-left:36pt" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">}</span></p>
<p></p>
<p><span>So that’s one bug -- t</span><span>hat means somehow this route is still executing even though the script has changed route. Instead, the timer should have been canceled by the route change, leaving the Passenger train stranded at the top of Summit.</span></p>
<p></p>
<p><span>As for the error/recovery, it’s perfectly reproducible in the simulator:</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">Script: [ML Recovery] PA start=false occup=2 total=2 [{B503b [NS787]}, {B503a [NS786]}, {B504 [NS784]}, {B321 [NS771]}, {B330 [NS773]}, &lt;B340 [NS774]&gt;, {B360 [NS775]}, &lt;B370 [NS776]&gt;]</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">Script: [ML Recovery] FR start=true occup=0 total=1 [&lt;B311 [NS769]&gt;, {B321 [NS771]}]</span></p>
<p style="margin-left:36pt;text-align:left" class="console "><span style="font-family:&quot;Consolas&quot;;font-size:9pt">Script: [ML Recovery] Ignore Passenger, Activate Freight</span></p>
<p></p>
<p><span>The core issue here is that’s a bug: if a route is abandoned because it goes into error mode, any delayed timer blocks should be abandoned and should definitely not execute.</span></p>
<p></p>
<p><span>The way the recovery should have worked is as follows:</span></p>
<ul style="margin:0">
 <li style="line-height:1.15;padding-bottom:0pt;padding-left:0pt;padding-top:0pt"><span>The Passenger route is active and the train running.</span></li>
 <li style="line-height:1.15;padding-bottom:0pt;padding-left:0pt;padding-top:0pt"><span>An unexpected block is activated &nbsp;⇒ This stops the train. The route is marked as being in error mode (This part works as expected).</span></li>
 <li style="line-height:1.15;padding-bottom:0pt;padding-left:0pt;padding-top:0pt"><span>The route selection should </span><span style="font-style:italic">ideally</span><span>&nbsp;respect the 1-minute pause I have when switching trains (This part is missing.)</span></li>
 <li style="line-height:1.15;padding-bottom:0pt;padding-left:0pt;padding-top:0pt"><span>The route selection should determine that the Passenger train is stuck at Summit, and consequently bring it back to the station. Once that is done, it can schedule the Freight train to leave.</span></li>
 <li style="line-height:1.15;padding-bottom:0pt;padding-left:0pt;padding-top:0pt"><span>Or the route selection should determine that the Passenger train is stuck at Summit, determine that there is at least one spurious block occupied on the track (B340), and thus decide it is not safe to bring back the Passenger train to the station. Better leave it where it is. Thus it’s fine to schedule the Freight train to leave.</span></li>
</ul>
<p></p>
<p><span>That last action is what’s happening, and it’s happening “as expected”. The only issue is that it happens </span><span style="font-style:italic">instantly</span><span>: block B340 gets activated, that stops the Passenger train, and </span><span style="font-style:italic">instantly</span><span>&nbsp;the route tries to “recover” and switches back to the Freight, because it that small millisecond the spurious block is still active. If there were a small pause in between, the block would not show activate anymore, and the Freight would not start instantly.</span></p>
<p></p>
<p><span>In essence, this is similar to </span><span style="-webkit-text-decoration-skip:none;color:rgb(17, 85, 204);text-decoration:underline;text-decoration-skip-ink:none"><a href="https://www.alfray.com/trains/blog/train/2024-10-12_conductor_2_sensor_issues_on_483b2f5d.html" style="color:inherit;text-decoration:inherit">the issue from the previous post</a></span><span>: if there’s spurious block activation when trying to start, the program should delay and try again a few minutes later.</span></p>
<p></p>
<p></p>
<hr>
<p></p>


    </div>



<div class="prev-next-container">


    <span class="prev-page"><a href="2024-11-21_dc-dc_boost_step-up_converter_xh-m411.html">⇐ Newer Post</a><br/></span>
    <span class="next-page"><a href="2024-10-12_conductor_2_sensor_issues_on_483b2f5d.html">Older Post ⇒</a><br/></span>

</div>

</div> <!-- container -->
</div> <!-- main -->

<div class="sharethis-inline-share-buttons"></div>

<div class="bottom-container">&nbsp;Generated on 2025-09-04 by Rig4j 0.1-Exp-05cc7b2&nbsp;</div>

</main>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-M1KDMEFC4D"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-M1KDMEFC4D');
</script>

</body>
</html>

